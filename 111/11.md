Minesweeper: Advanced Tactics
A Nasty Minesweeper Position
In this position, I know about a bunch of mines on all the remaining fronts, but I can't quite determine where they are. There are a few mines that might be in one of two positions (red or blue), a cluster of mines that might be in one of two arrangements (green), and a more complex situation in the top left which I haven't marked explicitly, involving the '5' and the '6'.



Minesweeper: Logic or Probability
Minesweeper can be played two ways: as a game of logic or as a game of probability.

Technically, probability subsumes logic. If you can logically prove a mine must be in a location, its probability must be 100%; if you can prove one cannot be, its probability must be 0%. So probability is all you need, in some sense. Nonetheless, you use logical deduction to detect those 100% situations; sometimes, especially at easier difficulty levels, that's all you need to complete a Minesweeper game; no appeal to probabilities is necessary.

But there are definitely situations where all the logic in the world won't save you. The 'T' situation which appears in the bottom center of the game board above is a simple example of this--slightly complicated by the extra nearby mines. (The simplest scenario replaces the '2' with a '1' and the '5' with a '3', so that it is symmetric.)

There is no way of getting any further information about the likely location of the one mine that remains in these two spaces. It's a 50-50 chance--a toss of a coin. When you find something like this, you're probably better off taking a guess right away, rather than saving it for later--so if you guess wrong, you won't have wasted a lot of extra time solving the rest of the board. (I'm a completist, so I save it for last, and don't blame myself for guessing wrong. And, mind you, it's a bad game design that puts the win or loss of the game on the toss of a coin.)

An Endgame Tactic
One very easy endgame tactic you can use is counting the number of remaining mines. Suppose I had resolved everything but the bottom right section of the board. Here are the only two configurations of mines that match the data:



If you reach this position and the counter says there are only two mines left, you're done; it must be position B.

If the counter says there are three left, it's not necessarily position A, though. It could be position B with the remaining mine in one of the lower-right 3x3 cluster of squares.

In fact, the odds are in favor of it being B.

Local Probabilities
If you only examine the probabilities "locally", you can see that each of the squares in the marked mutually exclusive groups have a 50-50 chance of being a mine. By locally, I mean that if you have a '1' next to two unknown squares, each has a 50% chance of being a mine.

The bottom center situation is exactly like this: each of squares adjacent to the unknown pair has exactly one mine unaccounted for, so each adjacent piece of data suggests a 50% chance. The very top left is similar:



The bottom right situation is somewhat like this as well; each of the numbers on the "front" has one mine unaccounted for and two squares where it might be.

If a square had one unaccounted-for mine next to it, but three unexplored squares, each square would have a probability of 33%; four unexplored squares would give each a 25% chance of having a mine. If it had two unaccounted-for mines and three unexplored squares, each would have a probability of 66%.

Here's the "local probability" situation for the full board:



As you can see, several squares in the top left area have more than one probability; the unexplored square adjacent to the '2' & '6' and the one adjacent to the '3' and the '5'. (The one by the '5' and the '6' still has 66% due to both, so there's no apparent incompatibility.)

Resolving Local Probability Conflicts
You should be wondering at this point what it means to have conflicting local probabilities. One intuition is that the bigger probability should win. For example, the square between the 6 and the 2 must really be 66%. That would mean the leftmost square that's assigned a 50% is actually only 33%, though. Or you might think you combine the priorities somehow; perhaps the chance should be 5/6, or the average.

But none of these are really correct. The data the probabilities are derived from aren't independent of one another, so no direct mathematics on the probabilities is valid. The reason a local guess of 50% is correct in the bottom center is because it really is independent of anything else. If you randomly constructed boards which matched all the data collected so far, exactly half of them would have the mine in each of the two possible locations. (Probabilty sometimes confuses people, who have trouble knowing what rules of probability apply in what situation. This approach is essentially a guaranteed valid way, because it underlies the definition of probability as predictive statistics: measure across all possible arrangements that might have led to the current situation, assuming each was equally probable.)

Thus, the correct measurement for the top left situation involves looking through all possible arrangements of mines that meet the currently collected data, and measuring which percentage of them has a mine in the correct position.

Это заняло бы довольно много времени, если бы мы делали это напрямую. К счастью, есть лучшие методы.

Подсчет договоренностей
Абстрактный способ вычисления вероятностей заключается в переборе всех возможных расположений мин, отбрасывании тех, которые не соответствуют собранным нами данным, и подсчете статистики для каждого возможного местоположения.

Более практичный подход — рассматривать только те, которые вообще не будут отброшены. Чтобы сделать это, вам придется применить логику и сгенерировать все возможные ситуации, которые могут соответствовать текущим данным. Я уже показал два сценария для нижнего правого угла; вот возможности для верхнего левого угла:



(Как и прежде, овал двойной высоты указывает на то, что мина может находиться в любой позиции с равной вероятностью. Я мог бы перечислить каждый из этих двух случаев отдельно, так что получилось бы 10 вариантов, но это не принесет пользы. Что касается организации: два ряда (пронумерованные «1» и «2») различаются по положению мины в четвертом ряду. Три столбца характеризуются по положению мин во втором ряду.)

Теперь у вас может возникнуть соблазн просто сказать: «Ага, есть пять случаев, поэтому мы можем подсчитать количество случаев для каждого возможного местоположения шахты». Например, мина в четвертом ряду (рядом с нижним левым «1») находится слева в двух случаях в ряду 1 и справа в трех случаях в ряду 2. Поэтому вы можете попытаться утверждать, что у нее есть 60% шанс оказаться справа, рядом с «6». (Это позиция, которая имеет противоречивые локальные вероятности 50% и 66%.)

Однако здесь упускается важная тонкость — количество мин в некоторых случаях разное: в A1 — 6 мин, в B2 — 4 мины , а в других случаях — 5.

Подсчет необнаруженных мин
Давайте вернемся к более простому сценарию в правом нижнем углу, чтобы подробно рассмотреть эту тонкость.



Предположим, что я завершил всю оставшуюся часть доски и знаю, что осталось ровно три мины.

Одним из соблазнов может быть предположение, что конфигурация A , с ровно тремя минами, более вероятна. Это неверно.

Другим искушением было бы посчитать, сколько всего было мин и сколько клеток на доске, и сказать «каковы шансы, что нижняя область 3x3 будет пустой». Это неверно. Точную причину, по которой это неверно, сложно объяснить, и, возможно, ее можно сравнить с «парадоксом» Let's-Make-a-Deal. Однако достаточно сказать, что фактические шансы для этой ситуации не зависят от общего количества мин и общего размера доски.

Настоящий ответ таков: сколько возможных расположений трех мин существует, которые соответствуют моим знаниям о доске? На рисунке показаны два: конфигурация A и конфигурация B. Но у B только две мины. Третья мина может находиться в любой нижней области 3 на 3 квадрата, для которой я не собрал никаких данных. Таким образом, существует девять вариантов конфигураций B ; я просто не приложил усилий, чтобы нарисовать их.

Таким образом, существует десять возможных расположений. Каждое из этих десяти расположений имеет одинаковую вероятность возникновения. (Как упоминалось ранее, это ключевое понятие для понимания вероятности. Вероятность того, что компьютер сгенерировал любой из этих случаев в первую очередь, была мала, но она была одинаково мала, потому что компьютер [насколько нам известно] давал каждому расположению равные шансы. Вы с одинаковой вероятностью выбросите десять орлов подряд, как и комбинацию два орла, одна решка, один орёл, три решки, один орёл, одна решка, один орёл . Вы с большей вероятностью выбросите в общей сложности пять орлов и пять решек, чем десять орлов, но не какую-либо конкретную комбинацию орлов и решек. В «Сапере» мы имеем дело с комбинациями мин, которые похожи на комбинации подбрасывания монеты.)

Поскольку каждая из десяти конфигураций (девять для B , одна для A ) имеет одинаковую вероятность возникновения, в этом конкретном сценарии конфигурация B имеет вероятность 90%!

Если бы в этот момент осталось четыре мины, то конфигурация A имела бы девять вариантов. Конфигурация B имела бы один вариант для каждого расположения двух мин в нижнем левом углу; это C (9,2) , что равно 9!/((9-2)! * 2!), или 9*8/2, что равно 36. В этом случае конфигурация B имеет только 75% вероятность.

При наличии пяти шахт конфигурация A имеет 36 вариантов, а конфигурация B имеет 9*8*7/6 = 84 варианта; таким образом, вероятность для B составляет чуть более 66%.

При шести минах вероятность B составляет около 60%. При семи минах вероятность B составляет всего 50%. При восьми минах вероятность B меньше , чем вероятность A; в этот момент в оставшиеся места нужно установить так много дополнительных мин, что конфигураций становится меньше. Рассмотрим наихудший случай, когда осталось 11 мин. (Это крайне маловероятно, но если бы это произошло, эти вероятности были бы применимы.) При конфигурации B все невстречавшиеся квадраты должны иметь мину; при конфигурации A все, кроме одного, имеют — и, таким образом, для A существует 9 вариантов , а для B — только один.

Окончательное решение
На обсуждаемой доске осталось 9 мин. Одна из них идет в нижний центр, где есть совершенно независимый выбор, который мы можем игнорировать. Поэтому мы рассматриваем всю доску, за исключением этого случая; неучтенных мин всего восемь. (Я продолжу явно считать овал в верхнем левом углу, поскольку он есть на картинке для верхнего левого угла, просто для определенности.)

Может возникнуть любая комбинация конфигурации верхнего левого угла и конфигурации нижнего правого угла, за исключением одной из них (A1 + A), которая потребует девяти мин. Поэтому нам нужно перечислить каждую из этих возможных конфигураций и подсчитать оставшиеся мины и невстреченные квадраты.

На самом деле количество невстреченных квадратов независимо: их девять в правом нижнем углу и три в левом верхнем, так что всего их 12.

Вверху слева	Внизу справа	Количество мин	Мины слева	Невстречавшиеся варианты
А1	Б	8	0	1
Б1	А	8	0	1
Б1	Б	7	1	12
А2	А	8	0	1
А2	Б	7	1	12
Б2	А	7	1	12
Б2	Б	6	2	66
С2	А	8	0	1
С2	Б	7	1	12

Таким образом, всего возможных комбинаций 118. Из этого можно посчитать количество комбинаций для каждой из конфигураций верхнего левого и нижнего правого по отдельности:

Конфигурация	Варианты	Процент
А1	1	1
Б1	13	11
А2	13	11
Б2	78	66
С2	13	11
А	15	13
Б	103	87

Затем я прошел по каждому квадрату на доске и вычислил его вероятность, сложив количество вариантов, в которых он появлялся, и разделив на 118. (На самом деле, просто сложив указанные выше проценты.) Кроме того, в среднем каждый невстречавшийся квадрат имел мину в 15 из 118 вариантов (в конце концов, вероятность того, что хотя бы один невстречавшийся квадрат имеет мину, очень высока). [Это можно вычислить, умножив количество оставшихся мин на количество невстречавшихся вариантов, что даст вам среднее количество мин на невстречавшихся квадратах.]



(Обратите внимание, что это не показывает всю доступную информацию. Например, мы знаем, что вероятность того, что два темно-зеленых квадрата «87» связаны — если один из них верен, то и другой должен быть. Аналогично, три бледно-голубых квадрата «13», которые являются минами для конфигурации A, также связаны. Оставшиеся бледно-голубые квадраты «13» не связаны — скорее, если какой-либо из них окажется миной, вероятность того, что любой из оставшихся окажется миной, уменьшается.)

Играя в игру
Скорее всего, вам не захочется садиться и решать все эти математические задачи, играя в игру «Сапер».

Я тоже.

Я перечислил возможные конфигурации в верхнем левом и нижнем правом углу. Я заметил, что одна конфигурация ( B2-B ) использовала на одну мину меньше, чем все остальные. Я применил правило "меньше мин означает больше невстреченных вариантов" (которое применяется примерно до тех пор, пока число невстреченных квадратов не станет меньше, чем вдвое больше числа неучтенных мин), что означает, что конфигурации, в которых используется меньше мин, гораздо более вероятны.

Поскольку в верхнем левом углу было много конфигураций, определение шансов для любого отдельного квадрата было довольно сложным. Поэтому я просто решил, что конфигурация B в нижнем правом углу была намного более вероятной, и угадал один из соответствующих квадратов. (Я надеялся, что это позволит мне завершить нижний правый, а затем, вооружившись большими знаниями о количестве оставшихся мин, я смогу завершить верхний левый, и мне останется только подбросить монету в центральном нижнем углу. Конечно, в идеале я бы выбрал квадрат, который максимизирует вероятность получения полезной информации, но любая из этих догадок позволила бы мне «войти» в нижний правый угол для дальнейшего сбора данных.) Шансы благоприятствовали конфигурации B , поэтому я выбрал квадрат , в котором была мина для конфигурации A.



В восьми случаях из девяти я был бы прав.


[ ДОМ ] [ ]